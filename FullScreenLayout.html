
<html>
<head>
    <meta charset="utf-8">
    <title>菜鸟教程(runoob.com)</title>

    <!--<link rel="stylesheet" href="http://static.runoob.com/assets/js/jquery-treeview/jquery.treeview.css" />-->
    <link rel="stylesheet" href="libs/jquery-treeview/jquery.treeview.css" />
    <!--<link rel="stylesheet" href="http://static.runoob.com/assets/js/jquery-treeview/screen.css" />-->
    <link rel="Stylesheet" href="libs/bootstrap/css/bootstrap.min.css" type="text/css" media="screen">

    <!--<script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>-->
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>

    <script src="libs/bootstrap/js/bootstrap.min.js"></script>
    <link rel=StyleSheet href="css/main.css" TYPE="text/css" MEDIA=screen>

    <!--<script src="http://static.runoob.com/assets/js/jquery-treeview/jquery.cookie.js"></script>-->
    <script src="libs/jquery-treeview/jquery.treeview.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(document).ready(function(){

            var currentElememt;

            $("#browser").treeview({
                toggle: function() {
                    console.log("%s was toggled.", $(this).find(">span").text());
                }
            });

            $("#add").click(function() {
                var branches = $("<li><span class='folder'>New Sublist</span><ul>" +
                        "<li><span class='file'>Item1</span></li>" +
                        "<li><span class='file'>Item2</span></li></ul></li>").appendTo("#browser");
                $("#browser").treeview({
                    add: branches
                });
            });

            $(".file,.folder").on("click",function (e) {
                var buttonGroup = $("#buttonGroup");
                if(buttonGroup!=null){
                    buttonGroup.remove();
                }
                currentElememt = $( event.target );

                var x = e.pageX +20+ 'px';
                var y = e.pageY -20+ 'px';
                $("#button-group").css({
                    "display":"block",
                    "position": "absolute",
                    "left": x,
                    "top": y
                });
            });

            $(document).on('click', '.file, .folder', function (e) {
                var buttonGroup = $("#buttonGroup");
                if (buttonGroup != null) {
                    buttonGroup.remove();
                }
                currentElememt = $(event.target);

                var x = e.pageX + 20 + 'px';
                var y = e.pageY - 20 + 'px';
                $("#button-group").css({
                    "display": "block",
                    "position": "absolute",
                    "left": x,
                    "top": y
                });
            });

            $("#edit").on('click',function () {
                currentElememt.attr("contentEditable","true");
            })
            $("#delete").on('click',function () {
                currentElememt.parent().remove();
                $("#button-group").css({
                    "display":"none",
                });
            })
            $("#conform").on('click',function () {
                currentElememt.attr("contentEditable","false");
                $("#button-group").css({
                    "display":"none",
                });

            })
            $("#addchild").on('click',function () {
                if(currentElememt.hasClass("folder")){
                    var newChild = $("<li><span class='file'>heiehihei</span></li>");
                    $( "ul .file" ).after( newChild);
                }else if(currentElememt.hasClass("file")){
                    currentElememt.removeClass("file");
                    currentElememt.addClass("folder");
                    var newChild = $("<ul><li><span class='file'>New Item</span></li> </ul>").appendTo(currentElememt.parent());
                }
            })
        });
    </script>
</head>
<body>
<div>
    <div id="main">
        <ul id="browser" class="filetree treeview-famfamfam">
            <li><span class="folder" >Folder 1</span>
                <ul>
                    <li><span class="folder">Item 1.1</span>
                        <ul>
                            <li><span class="file">Item 1.1.1</span></li>
                        </ul>
                    </li>
                    <li><span class="folder" >Folder 2</span>
                        <ul>
                            <li><span class="folder">Subfolder 2.1</span>
                                <ul id="folder21">
                                    <li><span class="file">File 2.1.1</span></li>
                                    <li><span class="file">File 2.1.2</span></li>
                                </ul>
                            </li>
                            <li><span class="folder">Subfolder 2.2</span>
                                <ul>
                                    <li><span class="file">File 2.2.1</span></li>
                                    <li><span class="file">File 2.2.2</span></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="closed"><span class="folder">Folder 3 (closed at start)</span>
                        <ul>
                            <li><span class="file">File 3.1</span></li>
                        </ul>
                    </li>
                    <li><span class="file">File 4</span></li>
                </ul>
            </li>
        </ul>

        <button id="add">Add!</button>


        <div class="buttonGroup" id="button-group">
            <button class='editButton' id='edit'><span class='glyphicon glyphicon-edit' aria-hidden='true' ></span></button>
            <button class='editButton' id='delete'><span class='glyphicon glyphicon-remove-circle' aria-hidden='true' ></span></button>
            <button class='editButton' id='addchild'><span class='glyphicon glyphicon-collapse-down' aria-hidden='true' ></span></button>
            <button class='editButton' id='conform'><span class='glyphicon glyphicon-ok-circle' aria-hidden='true' ></span></button>

        </div>

    </div>


</div>

</body></html>